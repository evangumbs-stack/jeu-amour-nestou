<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Jeu d'Amour pour Nestou ğŸ’–</title>
<style>
*{margin:0;padding:0;box-sizing:border-box;font-family:Arial,sans-serif;}
body{background:black;color:white;overflow-x:hidden;position:relative;}
.container{height:100vh;overflow-y:scroll;scroll-snap-type:y mandatory;}
.section{height:100vh;scroll-snap-align:start;display:flex;flex-direction:column;justify-content:center;align-items:center;padding:20px;}
button{padding:12px 20px;margin:10px;border:none;border-radius:10px;background:#ff4da6;color:white;font-size:16px;cursor:pointer;}
h1,h2{margin-bottom:15px;text-align:center;}
.score{position:fixed;top:10px;right:10px;background:#ff4da6;padding:10px;border-radius:10px;z-index:10;}
.popHeart{position:absolute;font-size:25px;animation:pop 0.6s ease-out;}
@keyframes pop{0%{transform:scale(0);opacity:1;}50%{transform:scale(1.3);}100%{transform:scale(0);opacity:0;}}
#stars{position:fixed;top:0;left:0;width:100%;height:100%;z-index:-2;overflow:hidden;}
.star{position:absolute;width:2px;height:2px;background:white;border-radius:50%;opacity:0.8;}
.shooting{position:absolute;width:3px;height:3px;background:white;border-radius:50%;box-shadow:0 0 10px white;}
#gameArea,#gameArea2,#gameArea3,#puzzleArea{position:relative;width:100%;height:60vh;overflow:hidden;display:flex;justify-content:center;align-items:center;flex-wrap:wrap;}
.item{position:absolute;font-size:30px;cursor:pointer;}
#basket{font-size:50px;position:absolute;bottom:180px;left:50%;transform:translateX(-50%);z-index:10;cursor:pointer;display:none;}
#basketFill{position:absolute;bottom:0;left:0;width:0%;height:30px;background:#ff4da6;border-radius:5px;pointer-events:none;}
#ticTacToe{display:grid;grid-template-columns:repeat(3,80px);gap:5px;margin-top:20px;}
.cell{width:80px;height:80px;background:#111a3a;color:white;font-size:30px;display:flex;justify-content:center;align-items:center;border:1px solid #ff4da6;}
.messageNext{margin-top:20px;font-size:18px;color:#ffd6e8;text-align:center;}
.finalHeart{position:absolute;font-size:30px;animation:floatUp 6s linear infinite;opacity:0.3;}
@keyframes floatUp{0%{transform:translateY(100vh) rotate(0deg);}100%{transform:translateY(-50px) rotate(360deg);}}
.finalWord{position:absolute;font-size:24px;color:#ff4da6;opacity:0.2;animation:floatUp 12s linear infinite;}
#finalPhoto{max-width:90%;max-height:80vh;border-radius:20px;margin:20px auto;display:block;}
/* Puzzle pieces */
.puzzlePiece{border:1px solid #fff;background-size:320px 320px;cursor:pointer;}
/* Section finale longue */
.section.finalSection{height:auto;min-height:200vh;justify-content:flex-start;align-items:center;position:relative;padding:50px 20px 500px 20px;}
</style>
</head>
<body>

<div id="stars"></div>
<div class="score">Score : <span id="score">0</span></div>
<audio id="music" src="TA_MUSIQUE.mp3" loop></audio>
<button style="position:fixed;top:50px;right:10px;z-index:10;" onclick="toggleMusic()">â¯ï¸ Musique</button>

<div class="container">
<!-- Section Accueil -->
<section class="section">
<h1>ğŸ’– Jeu d'Amour pour Nestou ğŸ’–</h1>
<p>Anne Esther, tu es mon trÃ©sor âœ¨ğŸ’–</p>
<button onclick="playMusic()">ğŸµ Lancer la musique</button>
<p>DÃ©file vers le bas â¬‡ï¸</p>
</section>

<!-- Section Questions -->
<section class="section">
<h2>Moment prÃ©fÃ©rÃ© ensemble ? ğŸ˜</h2>
<button onclick="answerAnim('moment','Miguel ğŸ¶',this)">Miguel ğŸ¶</button>
<button onclick="answerAnim('moment','Coucher de soleil ğŸŒ…',this)">Coucher de soleil ğŸŒ…</button>
<button onclick="answerAnim('moment','St Barth âœˆï¸',this)">St Barth âœˆï¸</button>
<button onclick="answerAnim('moment','Films ğŸ¬',this)">Films ğŸ¬</button>
</section>

<section class="section">
<h2>ActivitÃ© prÃ©fÃ©rÃ©e avec moi ? ğŸ’•</h2>
<button onclick="answerAnim('activity','Plage ğŸ–ï¸',this)">Plage ğŸ–ï¸</button>
<button onclick="answerAnim('activity','Lego ğŸ§±',this)">Lego ğŸ§±</button>
<button onclick="answerAnim('activity','Sushis ğŸ£',this)">Sushis ğŸ£</button>
<button onclick="answerAnim('activity','Sport ğŸƒâ€â™€ï¸',this)">Sport ğŸƒâ€â™€ï¸</button>
</section>

<section class="section">
<h2>Ton surnom prÃ©fÃ©rÃ© ? ğŸ˜˜</h2>
<button onclick="answerAnim('surnom','Ma Nestou ğŸ’–',this)">Ma Nestou ğŸ’–</button>
<button onclick="answerAnim('surnom','Mon trÃ©sor ğŸ’',this)">Mon trÃ©sor ğŸ’</button>
<button onclick="answerAnim('surnom','Mon amour â¤ï¸',this)">Mon amour â¤ï¸</button>
</section>

<section class="section">
<h2>Film ou sÃ©rie prÃ©fÃ©rÃ©e ? ğŸ¬</h2>
<button onclick="answerAnim('film','Malcom and Marie',this)">Malcom and Marie</button>
<button onclick="answerAnim('film','Eternal Sunshine',this)">Eternal Sunshine</button>
<button onclick="answerAnim('film','Waves',this)">Waves</button>
</section>

<!-- Section Puzzle -->
<section class="section">
<h2>ğŸ§© Puzzle 4x4</h2>
<div id="puzzleArea"></div>
<p class="messageNext" id="msgPuzzle"></p>
<button onclick="startPuzzle()">Lancer le puzzle</button>
</section>

<!-- Section Panier -->
<section class="section">
<h2>ğŸ§º Panier de cÅ“urs !</h2>
<div id="gameArea3"></div>
<div id="basket">ğŸ§º<div id="basketFill"></div></div>
<p class="messageNext" id="msg3"></p>
<button onclick="startMiniGame3()">Lancer</button>
</section>

<!-- Section Tic Tac Toe -->
<section class="section">
<h2>âŒ Tic Tac Toe ğŸ’•</h2>
<div id="ticTacToe"></div>
<p class="messageNext" id="msg4"></p>
<button onclick="startMiniGame4()">Lancer</button>
</section>

<!-- Section finale -->
<section class="section finalSection">
<h1>ğŸŒ¹ Ma Nestou ğŸŒ¹</h1>
<img id="finalPhoto" src="photo.jpg" alt="Nous deux">
<p id="finalMsg"></p>
</section>
</div>

<script>
// ===== Variables =====
let score=0, scoreGames=[0,0,0,0], answers={};
let music=document.getElementById("music"), musicPlaying=false;
function playMusic(){music.play();musicPlaying=true;}
function toggleMusic(){if(musicPlaying){music.pause();musicPlaying=false;}else{music.play();musicPlaying=true;}}
function updateScore(){document.getElementById("score").innerText=score;}

// ===== Question animation =====
function answerAnim(key,val,btn){
  answers[key]=val;
  const pop=document.createElement("div");
  pop.className="popHeart"; pop.innerText="ğŸ’–";
  const rect=btn.getBoundingClientRect();
  pop.style.left=rect.left+rect.width/2+"px";
  pop.style.top=rect.top-10+"px";
  document.body.appendChild(pop);
  setTimeout(()=>pop.remove(),600);
}

// ===== Stars =====
for(let i=0;i<100;i++){
  let s=document.createElement("div"); s.className="star";
  s.style.top=Math.random()*100+"%"; s.style.left=Math.random()*100+"%";
  s.style.width=Math.random()*2+1+"px"; s.style.height=s.style.width;
  document.getElementById("stars").appendChild(s);
}
function shootingStar(){
  let s=document.createElement("div"); s.className="shooting";
  s.style.top=Math.random()*50+"%"; s.style.left="-5%";
  document.getElementById("stars").appendChild(s);
  let id=setInterval(()=>{
    let left=parseFloat(s.style.left);
    if(left>105){s.remove();clearInterval(id);}else{s.style.left=(left+2)+"%";s.style.top=(parseFloat(s.style.top)+0.5)+"%";}
  },20);
}
setInterval(shootingStar,2000);

// ===== Puzzle 4x4 =====
function startPuzzle(){
  const puzzleArea=document.getElementById("puzzleArea");
  puzzleArea.innerHTML="";
  const size=4;
  let pieces=[];
  for(let i=0;i<size*size;i++){pieces.push(i);}
  shuffleArray(pieces);
  let firstClick=null;
  const pieceSize=80;

  for(let i=0;i<pieces.length;i++){
    const div=document.createElement("div");
    div.className="puzzlePiece";
    div.style.width=pieceSize+"px";
    div.style.height=pieceSize+"px";
    div.dataset.index=i;
    div.dataset.value=pieces[i];
    div.style.backgroundImage="url('ton_image.png')";
    div.style.backgroundPosition=`${-(pieces[i]%size)*pieceSize}px ${-Math.floor(pieces[i]/size)*pieceSize}px`;
    div.onclick=function(){
      if(firstClick===null){firstClick=div;div.style.border="2px solid #ff4da6";}
      else{
        swapPieces(firstClick,div);
        firstClick.style.border="1px solid #fff";
        firstClick=null;
      }
    }
    puzzleArea.appendChild(div);
  }

  let timeLeft=90;
  const timerMsg=document.getElementById("msgPuzzle");
  timerMsg.innerText=`Temps restant : ${timeLeft}s`;
  const countdown=setInterval(()=>{
    timeLeft--;
    timerMsg.innerText=`Temps restant : ${timeLeft}s`;
    if(timeLeft<=0){clearInterval(countdown);timerMsg.innerText="â° Temps Ã©coulÃ© ! Slide vers le jeu suivant â¬‡ï¸";}
  },1000);
}
function swapPieces(a,b){
  const tempValue=a.dataset.value;
  a.dataset.value=b.dataset.value;
  b.dataset.value=tempValue;
  const tempPos=a.style.backgroundPosition;
  a.style.backgroundPosition=b.style.backgroundPosition;
  b.style.backgroundPosition=tempPos;
}
function shuffleArray(array){
  for(let i=array.length-1;i>0;i--){
    const j=Math.floor(Math.random()*(i+1));
    [array[i],array[j]]=[array[j],array[i]];
  }
}

// ===== Panier 20s =====
function startMiniGame3(){
  const area=document.getElementById("gameArea3"); 
  area.innerHTML=""; 
  const basket=document.getElementById("basket"); 
  const fill=document.getElementById("basketFill");
  basket.style.display="block"; 
  fill.style.width="0%";
  fill.style.height="30px";
  let collected=0;
  const maxCollect=30; 
  basket.onmousedown=basket.ontouchstart=(e)=>{
    let offsetX=(e.clientX||e.touches[0].clientX)-basket.offsetLeft; 
    document.onmousemove=document.ontouchmove=(ev)=>{
      let basketX=(ev.clientX||ev.touches[0].clientX)-offsetX;
      if(basketX<0) basketX=0; 
      if(basketX>area.offsetWidth-basket.offsetWidth) basketX=area.offsetWidth-basket.offsetWidth;
      basket.style.left=basketX+"px";
    }
  };
  document.onmouseup=document.ontouchend=()=>{document.onmousemove=null;document.ontouchmove=null;};

  let interval=setInterval(()=>{
    const h=document.createElement("div"); h.className="item"; h.innerText="ğŸ’–";
    h.style.left=Math.random()*(area.offsetWidth-30)+"px"; h.style.top="-30px"; area.appendChild(h);
    let fall=setInterval(()=>{
      let top=parseFloat(h.style.top);
      if(top>area.offsetHeight){h.remove();clearInterval(fall);}
      else{
        h.style.top=(top+3)+"px";
        const hRect=h.getBoundingClientRect(); 
        const bRect=basket.getBoundingClientRect();
        if(!(hRect.right<bRect.left||hRect.left>bRect.right||hRect.bottom<bRect.top||hRect.top>bRect.bottom)){
          h.remove(); clearInterval(fall); 
          collected++; score++; scoreGames[2]++; updateScore();
          fill.style.width=Math.min(100,(collected/maxCollect*100))+"%";
        }
      }
    },20);
  },500);
  setTimeout(()=>{clearInterval(interval);basket.style.display="none";document.getElementById("msg3").innerText="â¬‡ï¸ Slide vers le jeu suivant â¬‡ï¸";},20000);
}

// ===== Tic Tac Toe IA =====
function startMiniGame4(){
  const grid=document.getElementById("ticTacToe"); grid.innerHTML=""; 
  let board=["","","","","","","","",""];
  let player="ğŸ£", ai="ğŸˆ";
  const timer=document.createElement("p"); timer.id="timerTTT"; timer.innerText=15; grid.parentNode.insertBefore(timer,grid);
  let time=15;

  function checkWin(b,symbol){const wins=[[0,1,2],[3,4,5],[6,7,8],[0,3,6],[1,4,7],[2,5,8],[0,4,8],[2,4,6]];return wins.some(w=>w.every(i=>b[i]===symbol));}
  function aiMove(){let empty=[];board.forEach((v,i)=>{if(v==="") empty.push(i);}); if(empty.length===0) return; let choice=empty[Math.floor(Math.random()*empty.length)]; board[choice]=ai; grid.children[choice].innerText=ai; score++; scoreGames[3]++; updateScore();}
  
  for(let i=0;i<9;i++){
    let c=document.createElement("div"); c.className="cell";
    c.onclick=()=>{
      if(board[i]===""){board[i]=player;c.innerText=player;score++; scoreGames[3]++; updateScore();
      setTimeout(aiMove,1000);}
    }
    grid.appendChild(c);
  }

  const countdown=setInterval(()=>{time--; timer.innerText=time; if(time<=0){clearInterval(countdown);document.getElementById("msg4").innerText="â¬‡ï¸ Slide vers le message final â¬‡ï¸"; showFinal();}},1000);
}

// ===== Message final =====
function showFinal(){
  const finalMsg=document.getElementById("finalMsg");
  finalMsg.innerText=
`ğŸ’– Mon amour ğŸ’–

Tes rÃ©ponses :
- Moment prÃ©fÃ©rÃ© : ${answers.moment||"Non choisi"}
- ActivitÃ© : ${answers.activity||"Non choisi"}
- Surnom : ${answers.surnom||"Non choisi"}
- Film/SÃ©rie : ${answers.film||"Non choisi"}

Scores des jeux :
- Puzzle : 0
- Panier : ${scoreGames[2]}
- Tic Tac Toe : ${scoreGames[3]}

Score total : ${score}

Chaque moment avec toi est prÃ©cieux : nos Lego, nos plages, nos couchers de soleil, nos voyages, nos sushis, nos sÃ©riesâ€¦ tout est plus beau avec toi.
Merci pour ton amour, ta patience et ta douceur. Tu es mon bonheur, mon refuge et mon cÅ“ur. ğŸ’–`;

  for(let i=0;i<50;i++){
    let h=document.createElement("div"); h.className="finalHeart"; h.innerText="ğŸ’–";
    h.style.left=Math.random()*100+"%"; h.style.top=Math.random()*100+"%"; document.body.appendChild(h);
  }
  const words=["ğŸ’–Je tâ€™aimeğŸ’–","ğŸŒ¹Mon trÃ©sorğŸŒ¹","ğŸ’•Ma NestouğŸ’•"];
  for(let i=0;i<30;i++){
    let w=document.createElement("div"); w.className="finalWord";
    w.innerText=words[Math.floor(Math.random()*words.length)];
    w.style.left=Math.random()*100+"%"; w.style.top=Math.random()*100+"%"; document.body.appendChild(w);
  }
}
</script>
</body>
</html>