<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Jeu d'Amour pour Nestou üíñ</title>
<style>
*{margin:0;padding:0;box-sizing:border-box;font-family:Arial,sans-serif;}
body{background:black;color:white;overflow-x:hidden;position:relative;}
.container{height:100vh;overflow-y:scroll;scroll-snap-type:y mandatory;}
.section{height:100vh;scroll-snap-align:start;display:flex;flex-direction:column;justify-content:center;align-items:center;padding:20px;position:relative;}
button{padding:12px 20px;margin:10px;border:none;border-radius:10px;background:#ff4da6;color:white;font-size:16px;cursor:pointer;}
h1,h2{margin-bottom:15px;text-align:center;}
.score{position:fixed;top:10px;right:10px;background:#ff4da6;padding:10px;border-radius:10px;z-index:10;}
.popHeart{position:absolute;font-size:25px;animation:pop 0.6s ease-out;}
@keyframes pop{0%{transform:scale(0);opacity:1;}50%{transform:scale(1.3);}100%{transform:scale(0);opacity:0;}}
#stars{position:fixed;top:0;left:0;width:100%;height:100%;z-index:-2;overflow:hidden;}
.star{position:absolute;width:2px;height:2px;background:white;border-radius:50%;opacity:0.8;}
.shooting{position:absolute;width:3px;height:3px;background:white;border-radius:50%;box-shadow:0 0 10px white;}
.item{position:absolute;font-size:30px;cursor:pointer;}
#basket{font-size:50px;position:absolute;bottom:0;left:50%;transform:translateX(-50%);z-index:10;cursor:pointer;display:none;}
#basketFill{position:absolute;bottom:0;left:0;width:0%;height:30px;background:#ff4da6;border-radius:5px;pointer-events:none;}
#ticTacToe{display:grid;grid-template-columns:repeat(3,80px);gap:5px;margin-top:20px;}
.cell{width:80px;height:80px;background:#111a3a;color:white;font-size:30px;display:flex;justify-content:center;align-items:center;border:1px solid #ff4da6;}
.messageNext{margin-top:20px;font-size:18px;color:#ffd6e8;text-align:center;}
.finalHeart{position:absolute;font-size:30px;animation:floatUp 6s linear infinite;opacity:0.3;}
@keyframes floatUp{0%{transform:translateY(100vh) rotate(0deg);}100%{transform:translateY(-50px) rotate(360deg);}}
.finalWord{position:absolute;font-size:24px;color:#ff4da6;opacity:0.2;animation:floatUp 12s linear infinite;}
#finalPhoto{max-width:90%;max-height:80vh;border-radius:20px;margin:20px auto;display:block;}

/* ===== Overlay pour chaque jeu ===== */
.gameOverlay{
  position:absolute;
  top:50%;
  left:50%;
  transform:translate(-50%,-50%);
  display:flex;
  flex-direction:column;
  justify-content:center;
  align-items:center;
  gap:10px;
  width:90%;
  text-align:center;
  z-index:5;
}

/* Section finale longue */
.section.finalSection{
  height:auto;
  min-height:200vh;
  justify-content:flex-start;
  align-items:center;
  position:relative;
  padding:50px 20px 500px 20px;
}

/* Puzzle styles */
.puzzleTile{
  cursor:pointer;
  border:1px solid #ff4da6;
  background-size:300% 300%;
  transition: transform 0.3s ease, border 0.3s ease;
}
.puzzleTile.selected{
  border:3px solid #ffd6e8;
  transform: scale(1.05);
}
#puzzleContainer{
  display:grid;
  grid-template-columns:repeat(3,1fr);
  grid-template-rows:repeat(3,1fr);
  width:80%;
  height:60vh;
  margin:auto;
  gap:5px;
}
</style>
</head>
<body>

<div id="stars"></div>
<div class="score">Score : <span id="score">0</span></div>
<audio id="music" src="TA_MUSIQUE.mp3" loop></audio>
<button style="position:fixed;top:50px;right:10px;z-index:10;" onclick="toggleMusic()">‚èØÔ∏è Musique</button>

<div class="container">
<!-- Section Quiz -->
<section class="section">
  <h1>üíñ Jeu d'Amour pour Nestou üíñ</h1>
  <p>Anne Esther, tu es mon tr√©sor ‚ú®üíñ</p>
  <button onclick="playMusic()">üéµ Lancer la musique</button>
  <p>D√©file vers le bas ‚¨áÔ∏è</p>
</section>

<!-- Puzzle 3x3 -->
<section class="section">
  <div class="gameOverlay" id="puzzleOverlay">
    <h2>üíñ Puzzle 3x3 üíñ</h2>
    <p>Assemble le puzzle !</p>
    <button onclick="startPuzzleGame()">Lancer</button>
  </div>
  <div id="puzzleContainer"></div>
  <p class="messageNext" id="msgPuzzle"></p>
</section>

<!-- Mini-jeu chatons -->
<section class="section">
  <div class="gameOverlay" id="catOverlay">
    <h2>üê± Attrape les chatons !</h2>
    <p>Clique sur les chatons qui tombent !</p>
    <button onclick="startMiniGame2()">Lancer</button>
  </div>
  <div id="gameArea2"></div>
  <p class="messageNext" id="msg2"></p>
</section>

<!-- Mini-jeu panier -->
<section class="section">
  <div class="gameOverlay" id="basketOverlay">
    <h2>üß∫ Panier de c≈ìurs !</h2>
    <p>D√©place le panier pour attraper les c≈ìurs !</p>
    <button onclick="startMiniGame3()">Lancer</button>
  </div>
  <div id="gameArea3"></div>
  <div id="basket"><div id="basketFill"></div>üß∫</div>
  <p class="messageNext" id="msg3"></p>
</section>

<!-- Tic Tac Toe IA -->
<section class="section">
  <div class="gameOverlay" id="ticOverlay">
    <h2>‚ùå Tic Tac Toe üíï</h2>
    <p>Joue contre l'IA !</p>
    <button onclick="startMiniGame4()">Lancer</button>
  </div>
  <div id="ticTacToe"></div>
  <p class="messageNext" id="msg4"></p>
</section>

<!-- Section finale -->
<section class="section finalSection">
  <h1>üåπ Ma Nestou üåπ</h1>
  <img id="finalPhoto" src="photo.jpg" alt="Nous deux">
  <p id="finalMsg"></p>
</section>
</div>

<script>
// ===== Variables =====
let score=0, scoreGames=[0,0,0,0], answers={};
let music=document.getElementById("music"), musicPlaying=false;
function playMusic(){music.play();musicPlaying=true;}
function toggleMusic(){if(musicPlaying){music.pause();musicPlaying=false;}else{music.play();musicPlaying=true;}}
function updateScore(){document.getElementById("score").innerText=score;}

// ===== Stars =====
for(let i=0;i<100;i++){
  let s=document.createElement("div"); s.className="star";
  s.style.top=Math.random()*100+"%"; s.style.left=Math.random()*100+"%";
  s.style.width=Math.random()*2+1+"px"; s.style.height=s.style.width;
  document.getElementById("stars").appendChild(s);
}
function shootingStar(){
  let s=document.createElement("div"); s.className="shooting";
  s.style.top=Math.random()*50+"%"; s.style.left="-5%";
  document.getElementById("stars").appendChild(s);
  let id=setInterval(()=>{
    let left=parseFloat(s.style.left);
    if(left>105){s.remove();clearInterval(id);}else{s.style.left=(left+2)+"%";s.style.top=(parseFloat(s.style.top)+0.5)+"%";}
  },20);
}
setInterval(shootingStar,2000);

// ===== Puzzle 3x3 =====
function startPuzzleGame(){
  document.getElementById("puzzleOverlay").style.display="none";
  const container=document.getElementById("puzzleContainer");
  container.innerHTML="";
  const size=3;
  let firstTile=null;
  let tiles=[];
  for(let i=0;i<size*size;i++){
    const tile=document.createElement("div");
    tile.className="puzzleTile";
    tile.dataset.correct=i;
    tile.style.backgroundImage="url('ton_image.png')";
    tile.style.backgroundPosition=`${(i%size)*(100/(size-1))}% ${(Math.floor(i/size)*(100/(size-1)))}%`;
    container.appendChild(tile);
    tiles.push(tile);
  }

  // shuffle
  tiles.sort(()=>Math.random()-0.5);

  container.addEventListener("click",function(e){
    if(!e.target.classList.contains("puzzleTile")) return;
    const tile=e.target;
    if(firstTile===null){firstTile=tile;firstTile.classList.add("selected");}
    else if(firstTile!==tile){swapTiles(firstTile,tile);firstTile.classList.remove("selected");firstTile=null;score++;scoreGames[0]++;updateScore();}
    else{firstTile.classList.remove("selected");firstTile=null;}
  });

  function swapTiles(t1,t2){
    const temp=t1.style.backgroundPosition;
    t1.style.backgroundPosition=t2.style.backgroundPosition;
    t2.style.backgroundPosition=temp;
    t1.style.transform="scale(1.1)"; t2.style.transform="scale(1.1)";
    setTimeout(()=>{t1.style.transform="scale(1)";t2.style.transform="scale(1)";},300);
  }
}

// ===== Mini-jeux chatons =====
function startMiniGame2(){
  document.getElementById("catOverlay").style.display="none";
  const area=document.getElementById("gameArea2"); area.innerHTML="";
  let interval=setInterval(()=>{
    const c=document.createElement("div"); c.className="item"; c.innerText="üê±";
    c.style.left=Math.random()*(area.offsetWidth-30)+"px"; c.style.top="-30px";
    area.appendChild(c);
    let fall=setInterval(()=>{
      let top=parseFloat(c.style.top);
      if(top>area.offsetHeight){c.remove();clearInterval(fall);}
      else{c.style.top=(top+3)+"px";}
    },20);
    c.onclick=c.ontouchstart=()=>{c.remove();score++;scoreGames[1]++;updateScore();}
  },600);
  setTimeout(()=>{clearInterval(interval);document.getElementById("msg2").innerText="‚¨áÔ∏è Slide vers le jeu suivant ‚¨áÔ∏è";},15000);
}

// ===== Mini-jeu panier =====
function startMiniGame3(){
  document.getElementById("basketOverlay").style.display="none";
  const area=document.getElementById("gameArea3"); area.innerHTML="";
  const basket=document.getElementById("basket"); const fill=document.getElementById("basketFill");
  basket.style.display="block"; fill.style.width="0%"; fill.style.height="30px";
  let collected=0; const maxCollect=30;
  basket.onmousedown=basket.ontouchstart=(e)=>{
    let offsetX=(e.clientX||e.touches[0].clientX)-basket.offsetLeft;
    document.onmousemove=document.ontouchmove=(ev)=>{
      let basketX=(ev.clientX||ev.touches[0].clientX)-offsetX;
      if(basketX<0) basketX=0;
      if(basketX>area.offsetWidth-basket.offsetWidth) basketX=area.offsetWidth-basket.offsetWidth;
      basket.style.left=basketX+"px";
    }
  };
  document.onmouseup=document.ontouchend=()=>{document.onmousemove=null;document.ontouchmove=null;};

  let interval=setInterval(()=>{
    const h=document.createElement("div"); h.className="item"; h.innerText="üíñ";
    h.style.left=Math.random()*(area.offsetWidth-30)+"px"; h.style.top="-30px"; area.appendChild(h);
    let fall=setInterval(()=>{
      let top=parseFloat(h.style.top);
      if(top>area.offsetHeight){h.remove();clearInterval(fall);}
      else{
        h.style.top=(top+3)+"px";
        const hRect=h.getBoundingClientRect(); const bRect=basket.getBoundingClientRect();
        if(!(hRect.right<bRect.left||hRect.left>bRect.right||hRect.bottom<bRect.top||hRect.top>bRect.bottom)){
          h.remove(); clearInterval(fall); collected++; score++; scoreGames[2]++; updateScore();
          fill.style.width=Math.min(100,(collected/maxCollect*100))+"%";
        }
      }
    },20);
  },500);
  setTimeout(()=>{clearInterval(interval);basket.style.display="none";document.getElementById("msg3").innerText="‚¨áÔ∏è Slide vers le jeu suivant ‚¨áÔ∏è";},15000);
}

// ===== Tic Tac Toe IA =====
function startMiniGame4(){
  document.getElementById("ticOverlay").style.display="none";
  const grid=document.getElementById("ticTacToe"); grid.innerHTML=""; let board=["","","","","","","","",""];
  let player="üç£", ai="üêà";

  for(let i=0;i<9;i++){
    const c=document.createElement("div"); c.className="cell";
    c.onclick=()=>{if(board[i]===""){board[i]=player;c.innerText=player;score++;scoreGames[3]++;updateScore();setTimeout(aiPlay,Math.random()*1000+1000);}}
    grid.appendChild(c);
  }

  function aiPlay(){
    const empty=board.map((v,i)=>v===""?i:null).filter(v=>v!==null);
    if(empty.length===0) return;
    const choice=empty[Math.floor(Math.random()*empty.length)];
    board[choice]=ai;
    grid.children[choice].innerText=ai;
  }
}

// ===== Message final =====
function showFinal(){
  const finalMsg=document.getElementById("finalMsg");
  finalMsg.innerText=
`üíñ Mon amour üíñ

Score total : ${score}

Chaque moment avec toi est pr√©cieux‚Ä¶ üíñ`;

  for(let i=0;i<50;i++){
    let h=document.createElement("div"); h.className="finalHeart"; h.innerText="üíñ";
    h.style.left=Math.random()*100+"%"; h.style.top=Math.random()*100+"%"; document.body.appendChild(h);
  }
}
</script>
</body>
</html>