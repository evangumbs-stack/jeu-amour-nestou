<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Jeu d'Amour pour Nestou ğŸ’–</title>
<style>
*{margin:0;padding:0;box-sizing:border-box;font-family:Arial,sans-serif;}
body{background:black;color:white;overflow-x:hidden;position:relative;}
.container{height:100vh;overflow-y:scroll;scroll-snap-type:y mandatory;}
.section{height:100vh;scroll-snap-align:start;display:flex;flex-direction:column;justify-content:center;align-items:center;padding:20px;}
button{padding:12px 20px;margin:10px;border:none;border-radius:10px;background:#ff4da6;color:white;font-size:16px;cursor:pointer;}
h1,h2{margin-bottom:15px;text-align:center;}
.score{position:fixed;top:10px;right:10px;background:#ff4da6;padding:10px;border-radius:10px;z-index:10;}
.popHeart{position:absolute;font-size:25px;animation:pop 0.6s ease-out;}
@keyframes pop{0%{transform:scale(0);opacity:1;}50%{transform:scale(1.3);}100%{transform:scale(0);opacity:0;}}
#stars{position:fixed;top:0;left:0;width:100%;height:100%;z-index:-2;overflow:hidden;}
.star{position:absolute;width:2px;height:2px;background:white;border-radius:50%;opacity:0.8;}
.shooting{position:absolute;width:3px;height:3px;background:white;border-radius:50%;box-shadow:0 0 10px white;}
#gameArea,#gameArea2,#gameArea3,#puzzleContainer{position:relative;width:100%;height:60vh;overflow:hidden;}
.item{position:absolute;font-size:30px;cursor:pointer;}
#basket{font-size:50px;position:absolute;bottom:180px;left:50%;transform:translateX(-50%);z-index:10;cursor:pointer;display:none;}
#basketFill{position:absolute;bottom:0;left:0;width:0%;height:30px;background:#ff4da6;border-radius:5px;pointer-events:none;}
#ticTacToe{display:grid;grid-template-columns:repeat(3,1fr);gap:5px;margin-top:20px;width:80%;max-width:300px;}
.cell{aspect-ratio:1/1;background:#111a3a;color:white;font-size:2.5rem;display:flex;justify-content:center;align-items:center;border:1px solid #ff4da6;}
.messageNext{margin-top:20px;font-size:18px;color:#ffd6e8;text-align:center;}
.finalHeart{position:absolute;font-size:30px;animation:floatUp 6s linear infinite;opacity:0.3;}
@keyframes floatUp{0%{transform:translateY(100vh) rotate(0deg);}100%{transform:translateY(-50px) rotate(360deg);}}
.finalWord{position:absolute;font-size:24px;color:#ff4da6;opacity:0.2;animation:floatUp 12s linear infinite;}
#finalPhoto{max-width:90%;max-height:80vh;border-radius:20px;margin:20px auto;display:block;}
.gameOverlay{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);text-align:center;width:90%;max-width:400px;background:rgba(0,0,0,0.5);padding:20px;border-radius:15px;}
.puzzleTile{cursor:pointer;border:1px solid #ff4da6;background-size:300% 300%;transition: transform 0.3s ease,border 0.3s ease;}
.puzzleTile.selected{border:3px solid #ffd6e8;transform:scale(1.05);}
#puzzleContainer{display:grid;grid-template-columns:repeat(3,1fr);grid-template-rows:repeat(3,1fr);width:80%;max-width:400px;height:60vh;margin:auto;gap:5px;}
.section.finalSection{height:auto;min-height:250vh;justify-content:flex-start;align-items:center;position:relative;padding:50px 20px 500px 20px;}
@media (max-width:500px){
  #ticTacToe{width:90%;}
  .cell{font-size:2rem;}
  #puzzleContainer{width:90%;height:50vh;}
}
</style>
</head>
<body>

<div id="stars"></div>
<div class="score">Score : <span id="score">0</span></div>
<audio id="music" src="TA_MUSIQUE.mp3" loop></audio>
<button style="position:fixed;top:50px;right:10px;z-index:10;" onclick="toggleMusic()">â¯ï¸ Musique</button>

<div class="container">
<section class="section">
<h1>ğŸ’– Jeu d'Amour pour Nestou ğŸ’–</h1>
<p>Anne Esther, tu es mon trÃ©sor âœ¨ğŸ’–</p>
<button onclick="playMusic()">ğŸµ Lancer la musique</button>
<p>DÃ©file vers le bas â¬‡ï¸</p>
</section>

<!-- Questions -->
<section class="section">
<h2>Moment prÃ©fÃ©rÃ© ensemble ? ğŸ˜</h2>
<button onclick="answerAnim('moment','Miguel ğŸ¶',this)">Miguel ğŸ¶</button>
<button onclick="answerAnim('moment','Coucher de soleil ğŸŒ…',this)">Coucher de soleil ğŸŒ…</button>
<button onclick="answerAnim('moment','St Barth âœˆï¸',this)">St Barth âœˆï¸</button>
<button onclick="answerAnim('moment','Films ğŸ¬',this)">Films ğŸ¬</button>
</section>

<section class="section">
<h2>ActivitÃ© prÃ©fÃ©rÃ©e avec moi ? ğŸ’•</h2>
<button onclick="answerAnim('activity','Plage ğŸ–ï¸',this)">Plage ğŸ–ï¸</button>
<button onclick="answerAnim('activity','Lego ğŸ§±',this)">Lego ğŸ§±</button>
<button onclick="answerAnim('activity','Sushis ğŸ£',this)">Sushis ğŸ£</button>
<button onclick="answerAnim('activity','Sport ğŸƒâ€â™€ï¸',this)">Sport ğŸƒâ€â™€ï¸</button>
</section>

<section class="section">
<h2>Ton surnom prÃ©fÃ©rÃ© ? ğŸ˜˜</h2>
<button onclick="answerAnim('surnom','Ma Nestou ğŸ’–',this)">Ma Nestou ğŸ’–</button>
<button onclick="answerAnim('surnom','Mon trÃ©sor ğŸ’',this)">Mon trÃ©sor ğŸ’</button>
<button onclick="answerAnim('surnom','Mon amour â¤ï¸',this)">Mon amour â¤ï¸</button>
</section>

<section class="section">
<h2>Film ou sÃ©rie prÃ©fÃ©rÃ©e ? ğŸ¬</h2>
<button onclick="answerAnim('film','Malcom and Marie',this)">Malcom and Marie</button>
<button onclick="answerAnim('film','Eternal Sunshine',this)">Eternal Sunshine</button>
<button onclick="answerAnim('film','Waves',this)">Waves</button>
</section>

<!-- Puzzle 3x3 -->
<section class="section" id="puzzleSection">
<h2>ğŸ’– Puzzle 3x3 ğŸ’–</h2>
<div class="gameOverlay" id="puzzleOverlay">
<p>Assemble le puzzle !</p>
<button onclick="startPuzzleGame()">Lancer</button>
</div>
<div id="puzzleContainer"></div>
<p class="messageNext" id="msgPuzzle"></p>
</section>

<!-- Mini-jeux -->
<section class="section" id="miniGame1Section">
<h2>ğŸ± Attrape les chatons !</h2>
<div class="gameOverlay" id="game1Overlay">
<p>Clique sur les chatons pour gagner des points !</p>
<button onclick="startMiniGame2()">Lancer</button>
</div>
<div id="gameArea2"></div>
<p class="messageNext" id="msg2"></p>
</section>

<section class="section" id="miniGame2Section">
<h2>ğŸ§º Panier de cÅ“urs !</h2>
<div class="gameOverlay" id="game2Overlay">
<p>DÃ©place le panier pour attraper les cÅ“urs !</p>
<button onclick="startMiniGame3()">Lancer</button>
</div>
<div id="gameArea3"></div>
<div id="basket">ğŸ§º<div id="basketFill"></div></div>
<p class="messageNext" id="msg3"></p>
</section>

<!-- Tic Tac Toe IA -->
<section class="section" id="tttSection">
<h2>âŒ Tic Tac Toe ğŸ’•</h2>
<div class="gameOverlay" id="tttOverlay">
<p>Place tes symboles !</p>
<button onclick="startMiniGame4()">Lancer</button>
</div>
<div id="ticTacToe"></div>
<p class="messageNext" id="msg4"></p>
</section>

<!-- Section finale longue -->
<section class="section finalSection">
<h1>ğŸŒ¹ Ma Nestou ğŸŒ¹</h1>
<img id="finalPhoto" src="photo.jpg" alt="Nous deux">
<p id="finalMsg"></p>
</section>
</div>

<script>
// ===== Variables =====
let score=0, scoreGames=[0,0,0,0], answers={};
let music=document.getElementById("music"), musicPlaying=false;
function playMusic(){music.play();musicPlaying=true;}
function toggleMusic(){if(musicPlaying){music.pause();musicPlaying=false;}else{music.play();musicPlaying=true;}}
function updateScore(){document.getElementById("score").innerText=score;}

// ===== Question animation =====
function answerAnim(key,val,btn){
  answers[key]=val;
  const pop=document.createElement("div");
  pop.className="popHeart"; pop.innerText="ğŸ’–";
  const rect=btn.getBoundingClientRect();
  pop.style.left=rect.left+rect.width/2+"px";
  pop.style.top=rect.top-10+"px";
  document.body.appendChild(pop);
  setTimeout(()=>pop.remove(),600);
}

// ===== Stars =====
for(let i=0;i<100;i++){
  let s=document.createElement("div"); s.className="star";
  s.style.top=Math.random()*100+"%"; s.style.left=Math.random()*100+"%";
  s.style.width=Math.random()*2+1+"px"; s.style.height=s.style.width;
  document.getElementById("stars").appendChild(s);
}
function shootingStar(){
  let s=document.createElement("div"); s.className="shooting";
  s.style.top=Math.random()*50+"%"; s.style.left="-5%";
  document.getElementById("stars").appendChild(s);
  let id=setInterval(()=>{
    let left=parseFloat(s.style.left);
    if(left>105){s.remove();clearInterval(id);}else{s.style.left=(left+2)+"%";s.style.top=(parseFloat(s.style.top)+0.5)+"%";}
  },20);
}
setInterval(shootingStar,2000);

// ===== Puzzle 3x3 =====
function startPuzzleGame(){
  document.getElementById("puzzleOverlay").style.display="none";
  const container=document.getElementById("puzzleContainer");
  container.innerHTML="";
  const size=3;
  let tiles=[];
  let firstTile=null;
  // CrÃ©ation des tuiles
  for(let i=0;i<size*size;i++){
    const tile=document.createElement("div");
    tile.className="puzzleTile";
    tile.dataset.correct=i;
    tile.style.backgroundImage="url('ton_image.png')";
    tile.style.backgroundPosition=`${(i%size)*(100/(size-1))}% ${(Math.floor(i/size)*(100/(size-1)))}%`;
    container.appendChild(tile);
    tiles.push(tile);
  }
  // MÃ©lange
  for(let i=tiles.length-1;i>0;i--){
    const j=Math.floor(Math.random()*(i+1));
    let tmpPos=tiles[i].style.backgroundPosition;
    tiles[i].style.backgroundPosition=tiles[j].style.backgroundPosition;
    tiles[j].style.backgroundPosition=tmpPos;
  }
  container.addEventListener("click",function(e){
    if(!e.target.classList.contains("puzzleTile")) return;
    const tile=e.target;
    if(firstTile===null){firstTile=tile;firstTile.classList.add("selected");}
    else if(firstTile!==tile){
      let temp=firstTile.style.backgroundPosition;
      firstTile.style.backgroundPosition=tile.style.backgroundPosition;
      tile.style.backgroundPosition=temp;
      firstTile.classList.remove("selected");firstTile=null;
      score++;scoreGames[0]++;updateScore();
      if(tiles.every((t,i)=>t.style.backgroundPosition===(i%size)*(100/(size-1))+"% "+Math.floor(i/size)*(100/(size-1))+"%")){
        document.getElementById("msgPuzzle").innerText="ğŸ‰ Bravo ! Puzzle rÃ©solu ! â¬‡ï¸ Slide vers le jeu suivant â¬‡ï¸";
      }
    } else {firstTile.classList.remove("selected");firstTile=null;}
  });
}

// ===== Mini-jeux =====
function startMiniGame2(){
  document.getElementById("game1Overlay").style.display="none";
  const area=document.getElementById("gameArea2"); area.innerHTML="";
  let interval=setInterval(()=>{
    const c=document.createElement("div"); c.className="item"; c.innerText="ğŸ±";
    c.style.left=Math.random()*(area.offsetWidth-30)+"px"; c.style.top="-30px"; area.appendChild(c);
    let fall=setInterval(()=>{
      let top=parseFloat(c.style.top);
      if(top>area.offsetHeight){c.remove();clearInterval(fall);} else{c.style.top=(top+3)+"px";}
    },20);
    c.onclick=c.ontouchstart=()=>{c.remove();score++;scoreGames[1]++;updateScore();}
  },600);
  setTimeout(()=>{clearInterval(interval);document.getElementById("msg2").innerText="â¬‡ï¸ Slide vers le jeu suivant â¬‡ï¸";},15000);
}

function startMiniGame3(){
  document.getElementById("game2Overlay").style.display="none";
  const area=document.getElementById("gameArea3"); area.innerHTML="";
  const basket=document.getElementById("basket"); const fill=document.getElementById("basketFill");
  basket.style.display="block"; fill.style.width="0%"; fill.style.height="30px";
  let collected=0; const maxCollect=30;
  basket.onmousedown=basket.ontouchstart=(e)=>{let offsetX=(e.clientX||e.touches[0].clientX)-basket.offsetLeft;document.onmousemove=document.ontouchmove=(ev)=>{let basketX=(ev.clientX||ev.touches[0].clientX)-offsetX;if(basketX<0) basketX=0; if(basketX>area.offsetWidth-basket.offsetWidth) basketX=area.offsetWidth-basket.offsetWidth; basket.style.left=basketX+"px";}};document.onmouseup=document.ontouchend=()=>{document.onmousemove=null;document.ontouchmove=null;};
  let interval=setInterval(()=>{
    const h=document.createElement("div"); h.className="item"; h.innerText="ğŸ’–";
    h.style.left=Math.random()*(area.offsetWidth-30)+"px"; h.style.top="-30px"; area.appendChild(h);
    let fall=setInterval(()=>{
      let top=parseFloat(h.style.top);
      if(top>area.offsetHeight){h.remove();clearInterval(fall);}
      else{
        h.style.top=(top+3)+"px";
        const hRect=h.getBoundingClientRect(); const bRect=basket.getBoundingClientRect();
        if(!(hRect.right<bRect.left||hRect.left>bRect.right||hRect.bottom<bRect.top||hRect.top>bRect.bottom)){
          h.remove(); clearInterval(fall); collected++; score++; scoreGames[2]++; updateScore();
          fill.style.width=Math.min(100,(collected/maxCollect*100))+"%";
        }
      }
    },20);
  },500);
  setTimeout(()=>{clearInterval(interval);basket.style.display="none";document.getElementById("msg3").innerText="â¬‡ï¸ Slide vers le jeu suivant â¬‡ï¸";},15000);
}

// ===== Tic Tac Toe IA =====
function startMiniGame4(){
  document.getElementById("tttOverlay").style.display="none";
  const grid=document.getElementById("ticTacToe"); grid.innerHTML=""; let board=["","","","","","","","",""];
  let current="ğŸ£"; 
  for(let i=0;i<9;i++){
    let c=document.createElement("div"); c.className="cell";
    c.onclick=()=>{if(board[i]===""){board[i]=current;c.innerText=current;score++;scoreGames[3]++;updateScore();currentPlay();}}
    grid.appendChild(c);
  }
  function currentPlay(){
    current="ğŸˆ";
    setTimeout(IAPlay,1000+Math.random()*1000);
  }
  function IAPlay(){
    const emptyCells=board.map((v,i)=>v===""?i:-1).filter(v=>v!==-1);
    if(emptyCells.length===0) return finishTTT();
    const move=emptyCells[Math.floor(Math.random()*emptyCells.length)];
    board[move]="ğŸˆ";
    grid.children[move].innerText="ğŸˆ";
    score++; scoreGames[3]++; updateScore();
    current="ğŸ£";
    if(board.includes("")) return;
    finishTTT();
  }
  function finishTTT(){document.getElementById("msg4").innerText="â¬‡ï¸ Slide vers le message final â¬‡ï¸"; showFinal();}
}

// ===== Message final =====
function showFinal(){
  const finalMsg=document.getElementById("finalMsg");
  finalMsg.innerText=
`ğŸ’– Mon amour ğŸ’–

Tes rÃ©ponses :
- Moment prÃ©fÃ©rÃ© : ${answers.moment||"Non choisi"}
- ActivitÃ© : ${answers.activity||"Non choisi"}
- Surnom : ${answers.surnom||"Non choisi"}
- Film/SÃ©rie : ${answers.film||"Non choisi"}

Scores des jeux :
- Puzzle : ${scoreGames[0]}
- Chatons : ${scoreGames[1]}
- Panier : ${scoreGames[2]}
- Tic Tac Toe : ${scoreGames[3]}

Score total : ${score}

Chaque moment avec toi est prÃ©cieux : nos Lego, nos plages, nos couchers de soleil, nos voyages, nos sushis, nos sÃ©riesâ€¦ tout est plus beau avec toi.
Merci pour ton amour, ta patience et ta douceur. Tu es mon bonheur, mon refuge et mon cÅ“ur. ğŸ’–`;

  for(let i=0;i<50;i++){let h=document.createElement("div"); h.className="finalHeart"; h.innerText="ğŸ’–"; h.style.left=Math.random()*100+"%"; h.style.top=Math.random()*100+"%"; document.body.appendChild(h);}
  const words=["ğŸ’–Je tâ€™aimeğŸ’–","ğŸŒ¹Mon trÃ©sorğŸŒ¹","ğŸ’•Ma NestouğŸ’•"];
  for(let i=0;i<30;i++){let w=document.createElement("div"); w.className="finalWord"; w.innerText=words[Math.floor(Math.random()*words.length)]; w.style.left=Math.random()*100+"%"; w.style.top=Math.random()*100+"%"; document.body.appendChild(w);}
}
</script>
</body>
</html>